---
layout: default
title: Using Parameters
---

<h1>Using Parameters</h1>

<p>
  There is support for parameterised statements, and using parameters when calling procedures.
</p>

<p>
  Input parameters are added to a Request using
  <a href="api-request.html#function_addParameter"><code>Request.addParameter()</code></a>,
  and output parameters are added using
  <a href="api-request.html#function_addOutputParameter"><code>Request.addOutputParameter()</code></a>
</p>

<h2>Parameter names</h2>
<p>
  In T-SQL, parameter names are identified by being prefixed with an '@'.
</p>

{% highlight sql %}
  select id from address where first_name = @name and age > @age
{% endhighlight %}

<p>
  The parameters names used in this API do not include the '@'.
</p>
{% highlight javascript %}
  request.addParameter('name', ..., ...);
  request.addParameter('age', ..., ...);
{% endhighlight %}

<h2>Input Parameters</h2>
<p>
  This is how input parameters might be used when executing a statement.
</p>

{% highlight javascript %}
  var TYPES = require('tedious').TYPES;

  var sql = 'select id from address where first_name = @name and age > @age';
  var request = new Request(sql, function(err) {
    ....
  });

  request.addParameter('name', TYPES.VarChar, 'Fred');
  request.addParameter('age', TYPES.Int, 42);

  connection.execSql(request);
{% endhighlight %}

<p>
  Calling a stored procedure with parameters works in a similar way.
</p>

{% highlight javascript %}
  var TYPES = require('tedious').TYPES;

  var request = new Request('get_addresses', function(err) {
    ....
  });

  request.addParameter('name', TYPES.VarChar, 'Fred');
  request.addParameter('age', TYPES.Int, 42);

  connection.callProcedure(request);
{% endhighlight %}

<h2>Output Parameters</h2>
<p>
  The values for output parameters are provided with emitted
  <a href="api-request.html#event_returnValue"><code>returnValue</code></a> events.
</p>

{% highlight javascript %}
  var TYPES = require('tedious').TYPES;

  var request = new Request("select @number=42, @string='qaz'", function(err) {
    ....
  });

  request.addOutputParameter('number', TYPES.Int);
  request.addOutputParameter('string', TYPES.VarChar);

  request.on('returnValue', function(parameterName, value, metadata) {
    console.log(parameterName + ' = ' + value);      // number = 42
                                                     // string = qaz
  });

  connection.execSql(request);
{% endhighlight %}

<h2>Table-Valued Parameters</h2>
<p>
  TVP are only supported when using <a href="api-connection.html#unction_callProcedure"><code>callProcedure</code></a>.
</p>

{% highlight javascript %}
  var TYPES = require('tedious').TYPES;
  
  var table = {
    columns: [
      {name: 'user_id', type: TYPES.Int},
      {name: 'user_name', type: TYPES.VarChar, length: 500},
      {name: 'user_enabled', type: TYPES.Bit}
    ],
    rows: [
      [15, 'Eric', true],
      [16, 'John', false]
    ]
  };

  var request = new Request("my_stored_procedure_name", function(err) {
    ....
  });

  request.addParameter('tvp', TYPES.TVP, table);

  connection.callProcedure(request);
{% endhighlight %}